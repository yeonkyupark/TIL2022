## TIL20220321

### ê°€ì„¤ê²€ì •

#### ë²”ì£¼í˜• ë°ì´í„°

##### í•œ ì§‘ë‹¨ì¼ ë•Œ

**ì¼ì› ì¹´ì´ ì œê³± ê²€ì •**

:   one sample $x^2$ test, ì í•©ì„± ê²€ì •ì—í™œìš©

```{r}
# ì£¼ì‚¬ìœ„ë¥¼ 60ë²ˆ ë˜ì ¸ ë•Œ, ê¸°ëŒ€ë¹ˆë„ì™€ ê´€ì¸¡ë¹ˆë„ê°€ ì í•©í•œì§€ ê²€ì •
# ê·€ë¬´ê°€ì„¤: ê¸°ëŒ€ë¹ˆë„ì™€ ê´€ì¸¡ë¹ˆë„ëŠ” ì°¨ì´ê°€ ì—†ë‹¤
# ëŒ€ë¦½ê°€ì„¤: ê¸°ëŒ€ë¹ˆë„ì™€ ê´€ì¸¡ë¹ˆë„ëŠ” ì°¨ì´ê°€ ìˆë‹¤.

chisq.test(c(4,6,17,15,9,9), p = rep(1/6, 6))
```

pê°’ì— ë”°ë¼ ìœ ì˜ìˆ˜ì¤€ 0.05ì—ì„œ ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•˜ê³  ëŒ€ë¦½ê°€ì„¤ì„ ì±„íƒí•œë‹¤. ì¦‰ ì£¼ì‚¬ìœ„ì˜ ê¸°ëŒ€ë¹ˆë„ì™€ ê´€ì¸¡ë¹ˆë„ì—ëŠ” ì°¨ì´ê°€ ìˆë‹¤ê³  íŒë‹¨í•  ìˆ˜ ìˆë‹¤.

```{r}
# í†µì‹  3ì‚¬ ì ìœ ìœ¨ ì°¨ì´ 40%, 30%, 30%ì¸ì§€ ê²€ì •
chisq.test(c(45, 30, 25), p = c(0.4, 0.3, 0.3))
```

##### ë‘ ì§‘ë‹¨ì¼ ë•Œ

**ì´ì› ì¹´ì´ ì œê³± ê²€ì •**

```{r}
if(!require(palmerpenguins)) { install.packages("palmerpenguins"); library(palmerpenguins); }
chisq.test(x=penguins$species, y=penguins$island)
```

```{r}
if(!require(gmodels)) { install.packages("gmodels"); library(gmodels); }

CrossTable(x=penguins$species, y=penguins$island, chisq = T)
```

##### í”¼ì…” ì •í™• ê²€ì •

ë¶„í• í‘œë¥¼ ê·¸ë¦° ë’¤ ì¹´ì´ ì œê³±ì„ ì ìš©í•  ë•Œ í‘œë³¸ ìˆ˜ê°€ ì ê±°ë‚˜ í‘œë³¸ì´ ë¶„íŒ”í‘œì˜ ì…€ì— ë§¤ìš° ì¹˜ìš°ì¹˜ê²Œ ë¶„í¬ë˜ì–´ ìˆë‹¤ë©´ ì¹´ì´ ì œê³± ê²€ì •ì˜ ê²°ê³¼ê°€ ë¶€ì •í™•í•  ìˆ˜ ìˆë‹¤. ê¸°ëŒ€ ë¹ˆë„ê°€ 5 ì´í•˜ì¸ ì…€ì´ ì „ì²´ì˜ 20% ìˆ˜ì¤€ì¼ ë•Œ í‘œë³¸ì˜ ìˆ˜ê°€ ì ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ì´ëŸ° ê²½ìš° Fisher's Exact Testë¥¼ ì ìš©í•œë‹¤.

```{r}
if(!require(MASS)) { install.packages("MASS"); library(MASS); }

xtabs( ~ W.Hnd + Clap, data = survey)
```

```{r}
chisq.test(survey$W.Hnd, survey$Clap)
```

```{r}
fisher.test(survey$W.Hnd, survey$Clap)
```

##### ë§¥ë‹ˆë§ˆ ê²€ì • (McNemar Test)

ì‚¬ê±´ ì „í›„ì˜ ì°¨ì´ ê²€ì •ì— í™œìš©ëœë‹¤.

```{r}
Performance <-
   matrix(c(794, 86, 150, 570),
          nrow = 2,
          dimnames = list(
          "1st Survey" = c("Approve", "Disapprove"),
          "2nd Survey" = c("Approve", "Disapprove")))
Performance
```

```{r}
mcnemar.test(Performance)
```

pê°’ì— ë”°ë¼ ì²«ë²ˆì§¸ ì¡°ì‚¬ì™€ ë‘ë²ˆì§¸ ì¡°ì‚¬ ê°„ì—ëŠ” ìœ ì˜í™•ë¥  0.05 í•˜ì—ì„œ í†µê³„ì ìœ¼ë¡œ ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ìˆë‹¤.

ì°¸ê³ ë¡œ, ì‚¬ê±´ ì „í›„ì˜ ì°¨ì´ ê²€ì •ì€ b=cë¥¼ ê²€í† í•˜ì—¬ ë³€í™” ì—¬ë¶€ë¥¼ íŒë‹¨í•  ìˆ˜ ìˆë‹¤. $$b \sim B(b+c, \frac{1}{2})$$

ë”°ë¼ì„œ ìœ„ ì˜ˆì œì˜ ê²½ìš° 86 \~ B(86+150, 1/2)ë¥¼ ê²€í† í•œë‹¤.

```{r}
binom.test(86, 86+150, 0.5)
```

#### ì—°ì†í˜• ë°ì´í„°

##### ì •ê·œì„± ê²€ì •

###### shapiro.test()

```{r}
shapiro.test(rnorm(1000))
```

###### ks.test()

ì½œëª¨ê³ ë¡œí”„ ìŠ¤ë¯¸ë¥´ë…¸í”„ ê²€ì •(Kolmogorov-Smirnov Test), ë‘ ìˆ«ì ë²¡í„° ê°„ì˜ ì°¨ì´ê°€ ì—†ëŠ”ì§€ë¥¼ ê²€ì •í•œë‹¤.

```{r}
ks.test(rnorm(100), rnorm(100))
```

```{r}
ks.test(rnorm(100), runif(100))
```

xë¥¼ ì •ê·œë¶„í¬ì—ì„œ ì¶”ì¶œí•˜ì˜€ëŠ”ì§€ ê²€ì •ì„ í•  ìˆ˜ë„ ìˆë‹¤.

```{r}
ks.test(rnorm(1000), "pnorm", 0 ,1)
```

```{r}
ks.test(runif(1000), "pnorm", c(0, 1))
```

###### qqplot()

```{r}
x <- rnorm(1000, mean = 10, sd = 1)
qqnorm(x); qqline(x, lty=2, col = "blue")
```

```{r}
x <- runif(1000)
qqnorm(x); qqline(x, lty=2, col = "red")
```

```{r}
qqplot(runif(1000, min=1, max=10), 1:10)
```

```{r}
qqplot(rnorm(1000), 1:1000)
```

##### í•œ ì§‘ë‹¨ì¼ ë•Œ

###### one sample t-test

####### ì •ê·œì„±ì„ ë§Œì¡±í•  ê²½ìš° t.test()

####### ì •ê·œì„±ì„ ë§Œì¡±í•˜ì§€ ëª»í•  ê²½ìš° wilcox.test(), Wilcoxon signed rank test

##### ë‘ ì§‘ë‹¨ì¼ ë•Œ

###### independent two sample t-test

####### ì •ê·œì„±ì„ ë§Œì¡±í•  ê²½ìš° t.test()

####### ì •ê·œì„±ì„ ë§Œì¡±í•˜ì§€ ëª»í•  ê²½ìš° wilcox.test(), Wilcoxon rank sum test

###### paired two sample t-test

####### ì •ê·œì„±ì„ ë§Œì¡±í•  ê²½ìš° t.test()

####### ì •ê·œì„±ì„ ë§Œì¡±í•˜ì§€ ëª»í•  ê²½ìš° wilcox.test(), Wilcoxon signed rank test with paired

##### ì„¸ ì§‘ë‹¨ ì´ìƒì¼ ë•Œ

####### ì •ê·œì„±ì„ ë§Œì¡±í•  ê²½ìš° aov()

####### ì •ê·œì„±ì„ ë§Œì¡±í•˜ì§€ ëª»í•  ê²½ìš° kruskal()

####### ì‚¬í›„ê²€ì •

Fisher's LSD, Bonferroni, Shelf, Turkey, Duncan ë“±

### ë¹„ìœ¨ê²€ì •

#### ì¼í‘œë³¸ binom.test()

#### ì´í‘œë³¸ prop.test()

### ë™ì§ˆì„± ê²€ì‚¬

#### ì´í‘œë³¸ var.test()

#### ì‚¼í‘œë³¸ ì´ìƒ bartlett.test()

## TIL20220322

### ë¹„ëª¨ìˆ˜ ê²€ì •

```{r}
if(!require(moonBook)) { install.packages("moonBook"); library(moonBook); }
if(!require(palmerpenguins)) { install.packages("palmerpenguins"); library(palmerpenguins); }
data <- penguins
densityplot(body_mass_g ~ sex, data = data)
```

0.  ì •ê·œì„± ê²€ì •

```{r}
shapiro.test(data$body_mass_g)
```

1.  Wilcoxon Rank Sum Test

```{r}
wilcox.result <- wilcox.test(body_mass_g ~ sex, data); wilcox.result
```

2.  Kruskal-Wallis Rank Sun Test

```{r}
kruskal.result <- kruskal.test(body_mass_g ~ species, data); kruskal.result
```

3.  ë‹¤ì¤‘ë¹„êµ mctp in nparcomp package

```{r}
if(!require(nparcomp)) { install.packages("nparcomp"); library(nparcomp); }
mctp(body_mass_g ~ species, data)
```

### ANOVA in R

#### ANOVA ê°€ì • ì ê²€

```{r}
if(!require(dplyr)) { install.packages("dplyr"); library(dplyr); }
if(!require(palmerpenguins)) { install.packages("palmerpenguins"); library(palmerpenguins); }
if(!require(ggplot2)) { install.packages("ggplot2"); library(ggplot2); }

data <- penguins %>% select(body_mass_g, species, sex) %>% na.omit()

ggplot(data, aes(species, body_mass_g, col=sex)) +
  geom_boxplot() +
  theme_bw()
```

í­ê·„ ì¢…ì— ë”°ë¥¸ ëª¸ë¬´ê²Œì˜ ìœ ì˜í•œ ì°¨ì´ê°€ ìˆëŠ”ì§€ ANOVAë¡œ ë¶„ì„í•œë‹¤. ì‹ ë¢°ì„± ìˆëŠ” ê²°ê³¼ ë„ì¶œì„ ìœ„í•´ ì•„ë˜ì˜ ê°€ì •ì„ í™•ì¸í•œë‹¤.

-   ë³€ìˆ˜ ìœ í˜• ë…ë¦½ë³€ìˆ˜ ë²”ì£¼í˜•, ì¢…ì†ë³€ìˆ˜ ì—°ì†í˜•

```{r}
str(data)
```

-   ë…ë¦½ì„±, *durbinWatsonTest()* í•¨ìˆ˜ë¥¼ í†µí•´ í†µê³„ì ìœ¼ë¡œ ê²€ì •

```{r}
if(!require(car)) { install.packages("car"); library(car); }

data.aov <- aov(body_mass_g ~ species, data)
durbinWatsonTest(data.aov)
```

-   ì •ê·œì„±

    -   Shapiro-Wilk normality test
    -   Kolmogorov-Smirnov test
    -   QQPlot, Histogram

    ```{r}
    # Shapiro-Wilk normality test
    shapiro.test(data.aov$residuals)
    ```

```{r}
# Kolmogorov-Smirnov test
ks.test(x = data$species, y = data$body_mass_g)
```

```{r}
# QQPlot, Histogram
qqPlot(data.aov)
```

-   ë“±ë¶„ì‚°ì„±
    -   Levene's test
    -   Bartlette test
    -   Boxplot

```{r}
leveneTest(body_mass_g ~ species, data)
```

```{r}
leveneTest(body_mass_g ~ species*sex, data)
```

```{r}
bartlett.test(body_mass_g ~ species, data)
```

```{r}
bartlett.test(body_mass_g ~ interaction(species,sex), data)
```

-   ì´ìƒì¹˜
    -   Boxplot, outlierTest()

```{r}
outlierTest(data.aov)
```

```{r}
range(data$body_mass_g); data[164,]
```

#### ANOVA

-   oneway.test(..., var.equal=)

```{r}
oneway.result <- oneway.test(body_mass_g ~ species, data, var.equal = F); oneway.result
```

-   aov()

```{r}
aov.result <- aov(body_mass_g ~ species, data)
summary(aov.result)
```

-   Kruskal-Wallis test (ì •ê·œì„± ë¶ˆë§Œì¡± ì‹œ)

```{r}
kruskal.test(body_mass_g ~ species, data)
```

#### ì‚¬í›„ê²€ì •

-   Tukey HSD

```{r}
TukeyHSD(aov.result)
```

```{r}
if(!require(multcomp)) { install.packages("multcomp"); library(multcomp); }
tukey.result <- glht(aov.result, 
                       linfct = mcp(species = "Tukey")); tukey.result
```

```{r}
plot(tukey.result, las=1)
```

-   Dunnett

```{r}
if(!require(multcomp)) { install.packages("multcomp"); library(multcomp); }
dunnett.result <- glht(aov.result, 
                       linfct = mcp(species = "Dunnett")); dunnett.result
```

-   Bonferroni correction

```{r}
pairwise.t.test(data$body_mass_g, data$species, p.adjust.method = "bonferroni")
```

## TIL20220323

### íˆíŠ¸ë§µ in R

```{r}
if(!require(palmerpenguins)) { install.packages("palmerpenguins"); library(palmerpenguins); }
data <- penguins

data.matrix <- as.matrix(cor(data[,3:6], use="complete.obs"))
```

#### heatmap() in base

```{r}
if(!require(reshape2)) { install.packages("reshape2"); library(reshape2); }

heatmap(data.matrix, Rowv = NA, Colv = NA)

```

#### heatmap.2() in gplots

```{r}
if(!require(gplots)) { install.packages("gplots"); library(gplots); }
heatmap.2(data.matrix, Rowv = NA, Colv = NA, )
```

#### geom_tile() in ggplot2

```{r}
if(!require(reshape2)) { install.packages("reshape2"); library(reshape2); }
if(!require(ggplot2)) { install.packages("ggplot2"); library(ggplot2); }


data.melted <- melt(data.matrix); head(data.melted)

ggplot(data.melted, aes(x=Var1, y=Var2, fill = value)) +
  geom_tile() +
  scale_fill_gradient2(low="red", mid = "white", high="blue") +
  guides(fill = guide_colorbar(barwidth = .5, barheight = 15))
```

## TIL20220324

### ê¸°ê³„í•™ìŠµ ëª¨ë¸ë§ with Caret

1.  ë°ì´í„° ì¤€ë¹„
2.  ë°ì´í„° íƒìƒ‰
3.  ë°ì´í„° ì „ì²˜ë¦¬
4.  ë°ì´í„° ë¶„í• 
5.  ëª¨ë¸ í•™ìŠµ
6.  ì˜ˆì¸¡ ë° ì„±ëŠ¥í‰ê°€
7.  ëª¨ë¸ ê°œì„ 

```{r}
# ë°ì´í„° ì¤€ë¹„
if(!require(dplyr)) { install.packages("dplyr"); library(dplyr); }
if(!require(caret)) { install.packages("caret"); library(caret); }
if(!require(ggplot2)) { install.packages("ggplot2"); library(ggplot2); }
if(!require(mlbench)) { install.packages("mlbench"); library(mlbench); }
data <- BreastCancer
```


```{r}
# ë°ì´í„° íƒìƒ‰
str(data)
```


```{r}
summary(data)
```

```{r}
colSums(is.na(data))
```

```{r}
table(data$Class)
```


```{r}
# ë°ì´í„° ì „ì²˜ë¦¬
if(!require(dplyr)) { install.packages("dplyr"); library(dplyr); }

data <- data %>% select(-Id) # í•„ìš”í•œ ì»¬ëŸ¼ ì œì™¸
data <- data %>% na.omit() # ê²°ì¸¡ì¹˜ ì œì™¸ (16/699ì´ë¯€ë¡œ)
```


```{r}
# ë°ì´í„° ë¶„í• 
if(!require(caret)) { install.packages("caret"); library(caret); }

train.index <- createDataPartition(data$Class, p=.7, list=F)
data.train <- data[train.index, ]
data.test <- data[-train.index, ]
```


```{r}
# ëª¨ë¸ í•™ìŠµ
trCtrl.up <- trainControl(sampling = "up")
trCtrl.down <- trainControl(sampling = "down")

model.dt.up <- train(Class ~ ., data = data.train, method = "rpart", trControl = trCtrl.up)
model.dt.down <- train(Class ~ ., data = data.train, method = "rpart", trControl = trCtrl.down)

model.list <- list(up = model.dt.up, down = model.dt.down)
model.resamples <- resamples(model.list)
dotplot(model.resamples)
```


```{r}
# ì˜ˆì¸¡ ë° ì„±ëŠ¥í‰ê°€
model.dt.up.pred <- predict(model.dt.up, data.test)
model.dt.down.pred <- predict(model.dt.down, data.test)
rbind(up = mean(model.dt.up.pred == data.test$Class),
      down = mean(model.dt.down.pred == data.test$Class) )
```

```{r}
if(!require(pROC)) { install.packages("pROC"); library(pROC); }
model.dt.up.pred <- predict(model.dt.up, data.test, type = "prob")
model.dt.down.pred <- predict(model.dt.down, data.test, type = "prob")
roc(data.test$Class, model.dt.up.pred[,1], plot=T, print.auc=T, col="red")
roc(data.test$Class, model.dt.down.pred[,1], plot=T, print.auc=T, add=T, col="blue", print.auc.adj=c(0,-1))
text(1.2, 0.8, "Blue: Down sampling\nRed: Up sampling")
```
### ë‹¤ì¤‘ë²”ì£¼ ROC

```{r}
if(!require(rpart)) { install.packages("rpart"); library(rpart); }
data <- penguins
data <- na.omit(data)
set.seed(1234)
train.index <- sample(nrow(data), 0.7*nrow(data), replace=F) 
train <- data[train.index,]
test <- data[-train.index,]
model.dt <- rpart(species ~ ., train)
model.dt.pred <- predict(model.dt, test, type="class")

if(!require(pROC)) { install.packages("pROC"); library(pROC); }
mroc <- multiclass.roc(test$species, as.numeric(model.dt.pred))
pROC::plot.roc(mroc$rocs[[1]], plot=T, col=1, print.auc=T)
for(i in 2:3) {
  pROC::plot.roc(mroc$rocs[[i]], plot=T, col=i, print.auc=T, add=T,
                 print.auc.adj = c(0,i))
}
```

## TIL20220325

ì•„... ì´ë‚ ì€ ìŠì§€ ë§ì ğŸ¤®

## TIL20220326

[Github] ê¹ƒí—ˆë¸Œ ì»¤ë°‹ ë‚ ì§œë¥¼ ì¡°ì‘í•˜ê³  ì‹¶ì§€ ì•Šìœ¼ì‹ ê°€ìš”? ^[https://cindycho.tistory.com/71]  

ì´ê²Œ ë˜ëŠ”êµ¬ë‚˜...

## TIL20220327

```{r}
if(!require(ggplot2)) { install.packages("ggplot2"); library(ggplot2); }

x <- seq(-4, 4, length=100)
y3 <- dt(x, df=3)
y10 <- dt(x, df=10)
y50 <- dt(x, df=50)

ggplot(data.frame(x,y3), aes(x,y3)) +
  geom_line(col=1) +
  geom_line(aes(x, y10), col=2) +
  geom_line(aes(x, y50), col=3) +
  geom_text(aes(-3, 0.3, label="df=50"), color=3) +
  geom_text(aes(-3, 0.25, label="df=10"), col=2) +
  geom_text(aes(-3, 0.2, label="df=3"), col=1) +
  theme_bw()
```

```{r}
str(cars)
plot(cars$speed, cars$dist)
```


```{r}
x <- seq(-4, 4, length=100)
y1 <- dnorm(x, sd=1)
y2 <- dnorm(x, sd=2)
ggplot(data.frame(x,y1), aes(x,y1)) +
  geom_line() +
  geom_line(aes(y=y2), col=2)
```

$$CV, coefficient of variance = \frac{s}{\bar x}$$

```{r}
if(!require(palmerpenguins)) { install.packages("palmerpenguins"); library(palmerpenguins); }
pa <- subset(penguins[penguins$species=="Adelie", ], select = c("species", "body_mass_g"))
pg <- subset(penguins[penguins$species=="Gentoo", ], select = c("species", "body_mass_g"))

pa.cv <- sd(pa$body_mass_g, na.rm=T)/mean(pa$body_mass_g, na.rm = T)
pg.cv <- sd(pg$body_mass_g, na.rm=T)/mean(pg$body_mass_g, na.rm = T)
cv <- rbind(Adelie = pa.cv, Gentoo = pg.cv)
colnames(cv) <- c("CV"); cv
```

Adelieê°€ Gentooì— ë¹„í•´ ë³€ë™ì„±ì´ í° ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.

```{r}
boxplot(pa$body_mass_g, pg$body_mass_g)
```

## TIL20220328

`ë² ë¥´ëˆ„ì´ ì‹œí–‰`  
:  pì˜ í™•ë¥ ë¡œ ì›í•˜ëŠ” ê²°ê³¼ê°€ ë‚˜íƒ€ë‚¬ì„ ë•Œ ì„±ê³µìœ¼ë¡œ (1-p)ì˜ í™•ë¥ ë¡œ ê·¸ë ‡ì§€ ì•Šì€ ê²°ê³¼ê°€ ë‚˜íƒ€ë‚¬ì„ ë•Œ ì‹¤íŒ¨ë¡œ í•˜ëŠ” ë‘ ê°€ì§€ ê²°ê³¼ê°€ ë‚˜íƒ€ë‚˜ëŠ” í™•ë¥ ì‹¤í—˜ì„ ë² ë¥´ëˆ„ì´ ì‹œí–‰ì´ë¼ í•œë‹¤.  

`ì´í•­ ë¶„í¬`  
:  ì„±ê³µ í™•ë¥ ì´ pë¡œ ë™ì¼í•œ ë² ë¥´ëˆ„ì´ ì‹œí–‰ì„ në²ˆ ë°˜ë³µí•´ì„œ ì‹¤í—˜í•˜ëŠ” ê²½ìš°, ì‹¤í—˜ì´ në²ˆ ë°˜ë³µë˜ë”ë¼ë„ ì„±ê³µ í™•ë¥  pëŠ” ë³€í•˜ì§€ ì•Šê³  ë™ì¼í•œê²ƒìœ¼ë¡œ ì´ëŠ” ì•ì˜ ì‹¤í—˜ì´ ë’¤ì— í•  ì‹¤í—˜ì— ì˜í–¥ì„ ë¼ì¹˜ì§€ ì•Šê³  ê° ì‹¤í—˜ì´ ì„œë¡œ ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ë  ë•Œ ì´ì™€ ê°™ì€ ì‹¤í—˜ì—ì„œ ì„±ê³µ íšŸìˆ˜ê°€ ë”°ë¥´ëŠ” ë¶„í¬í•¨ìˆ˜ë¥¼ ì´í•­ë¶„í¬ë¼ í•œë‹¤.  

`ì´í•­ ê³„ìˆ˜`  
:  $p^x(1-p)^{n-x}$


```{r}
n <- 6
p <- 1/3
x <- 0:n

dbinom(2, size = n, prob = p)
dbinom(4, size = n, prob = p)
px <- dbinom(x, size = n, prob = p)
plot(x, px, type="s",xlab="ì„±ê³µíšŸìˆ˜", ylab="í™•ë¥ ", main="B(6, 1/3)")
```

```{r}
# B(6, 1/3)ì˜ ê¸°ëŒ“ê°’ê³¼ ë¶„ì‚°
n <- 6
p <- 1/3
x <- 0:n
px <- dbinom(x, size = n, prob = p)

ex <- sum(x * px)
ex2 <- sum(x^2 * px)

# V(X) = E(X^2) - {E(X)}^2
varx <- ex2 - ex^2; varx
```

```{r}
options(digits = 3)

mu = 170
sigma <- 6
ll <- mu - 3*sigma
ul <- mu + 3*sigma

x <- seq(ll, ul, by=0.01)
nd <- dnorm(x, mean=mu, sd=sigma)
plot(x, nd, type="l", xlab="x", ylab="P(X=x)", lwd=2, col="red"); abline(v=mu)
```

```{r}
options(digis=5)
set.seed(5)
smp <- rnorm(400, mean=mu, sd=sigma)
c(mean(smp), sd(smp))
hist(smp, prob=T, main="N(170, 6^2)ìœ¼ë¡œë¶€í„° ì¶”ì¶œí•œ í‘œë³¸ì˜ ë¶„í¬(n=400)", xlab="", ylab="", border="black"); lines(x, nd, lty=2)
```

```{r}
x <- seq(ll, ul, length = 400)
nd <- dnorm(x, mean=mean(smp), sd=sd(smp))
plot(x, nd, type="l", xlab="x", ylab="P(X=x)", lwd=2, col="red");abline(v=mean(smp))
```

## TIL20220329

```{r}
v <- c(1,4,5)
for (i in v) {
  print(i)
}
```

`ëª¨ìˆ˜`  
:  ëª¨ì§‘ë‹¨ì˜  íŠ¹ì„±ì„ ë‚˜íƒ€ë‚´ëŠ” ê°’, parameter  

`í†µê³„ëŸ‰`  
:  í‘œë³¸ìœ¼ë¡œë¶€í„° ê´€ì°°ë˜ëŠ” í‘œë³¸ì˜ íŠ¹ì„±, statistic  

`í‘œë³¸ë¶„í¬`  
:  í‘œë³¸ í¬ê¸°ê°€ nìœ¼ë¡œ ì •í•´ì¡Œì„ ë•Œ ì¶”ì¶œë  ìˆ˜ ìˆëŠ” ëª¨ë“  í‘œë³¸ìœ¼ë¡œë¶€í„° êµ¬í•œ í†µê³„ëŸ‰ë“¤ë¡œ êµ¬ì„±ëœ í™•ë¥ ë¶„í¬

```{r}
# ëª¨ì§‘ë‹¨ 100ê°œ ì¤‘ í‘œë³¸ í¬ê¸° 10ì´ ë˜ë„ë¡ í•˜ëŠ” í‘œë³¸ì¶”ì¶œì˜ ê²½ìš°ì˜ ìˆ˜
choose(100, 10)
```

```{r}
# ì¹´ë“œ 4ì¥ ì¤‘ 2ì¥ ì„ íƒ
choose(4, 2)
```

í‘œë³¸í‰ê·  $\bar{x}$ì˜ ë¶„í¬

```{r}
m10 <- rep(NA, 1000)
m40 <- rep(NA, 1000)
set.seed(9)
for(i in 1:1000) {
  m10[i] <- mean(rnorm(10))
  m40[i] <- mean(rnorm(40))
}

options(digits = 4)
c(mean(m10), sd(m10))
c(mean(m40), sd(m40))

par(mfrow = c(1,2))
hist(m10, xlim = c(-1.5, 1.5), main="", xlab="x", ylab="y",
     col="cyan", border = "blue")
hist(m40, xlim = c(-1.5, 1.5), main="", xlab="x", ylab="y",
     col="cyan", border = "blue")
par(mfrow = c(1,1))
```

í‘œë³¸ í¬ê¸°ê°€ í´ìˆ˜ë¡ ê¸°ëŒ“ê°’ ì£¼ë³€ì— ë§ì´ ëª°ë ¤ ìˆìœ¼ë©° ìë£Œê°€ ë¶„í¬í•˜ëŠ” ì „ì²´ í­ì´ ì¤„ì–´ë“¦ì„ ë³¼ ìˆ˜ ìˆë‹¤.

## TIL20220330

### ì •ê·œë¶„í¬ì—ì„œ ì¶”ì¶œí•œ í‘œë³¸í‰ê· ì˜ ë¶„í¬

```{r}
set.seed(9)
n <- 1000
r.1.mean <- rep(NA, n)
r.2.mean <- rep(NA, n)

for(i in 1:n) {
  r.1.mean[i] <- mean(rnorm(4, mean=3, sd=1))
  r.2.mean[i] <- mean(rnorm(4, mean=170, sd=6))
}

options(digits = 4)
c(mean(r.1.mean), sd(r.1.mean))
c(mean(r.2.mean), sd(r.2.mean))

{hist(r.1.mean, prob=T, xlab="í‘œë³¸í‰ê· ", ylab="ë°€ë„", main="", col="orange", border="red")
x1 <- seq(min(r.1.mean), max(r.1.mean), length=1000)
y1 <- dnorm(x=x1, mean=3, sd=(1/sqrt(4)))
lines(x1, y1, lty=2, lwd=2, col="blue")}
```

```{r}
{hist(r.2.mean, prob=T, xlab="í‘œë³¸í‰ê· ", ylab="ë°€ë„", main="", col="orange", border="red")
x2 <- seq(min(r.2.mean), max(r.2.mean), length=1000)
y2 <- dnorm(x=x2, mean=170, sd=(6/sqrt(4)))
lines(x2, y2, lty=2, lwd=2, col="blue")}
```

ëª¨ì§‘ë‹¨ì´ ì •ê·œë¶„í¬ë¥¼ ë‹¤ë¥¼ ê²½ìš° í‘œë³¸í‰ê· ì˜ ë¶„í¬ê°€ ì •ê·œë¶„í¬ì™€ ìœ ì‚¬í•¨ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

$$
\bar{X} \sim N(\mu, (\frac{\sigma}{\sqrt{n}})^2)
$$

### ëª¨ì§‘ë‹¨ì´ ì •ê·œë¶„í¬ ì´ì™¸ì˜ ë¶„í¬ë¥¼ ë”°ë¥¼ ê²½ìš°

ì‹œí–‰íšŸìˆ˜ê°€ 10íšŒ, ì„±ê³µí™•ë¥ ì´ 0.1ì¸ ì´í•­ë¶„í¬ B(10, 0.1)ì˜ í‰ê·  1, í‘œì¤€í¸ì°¨ 0.9487ì¼ ë•Œ, í‘œë³¸ í¬ê¸° 2,4,32ë¡œ ëŠ˜ë¦´ ê²½ìš°

B(10, 01), E(X) = np, VAR(X) = np(1-p)ì´ë¯€ë¡œ

```{r}
t <- 10; p <- 0.1; x <- 0:10;
px <- dbinom(0:10, 10, prob=0.1)
names(px) <- 0:10
barplot(px, col="orange", border="red")
```

```{r}
set.seed(9)
t <- 10
p <- 0.1
x <- 0:10
n <- 1000
b.2.mean <- rep(NA, n)
b.4.mean <- rep(NA, n)
b.32.mean <- rep(NA, n)

for(i in 1:n) {
  b.2.mean[i] <- mean(rbinom(2, size=t, prob=p))
  b.4.mean[i] <- mean(rbinom(4, size=t, prob=p))
  b.32.mean[i] <- mean(rbinom(32, size=t, prob=p))
}

options(digits = 4)
c(mean(b.2.mean), sd(b.2.mean))
c(mean(b.4.mean), sd(b.4.mean))
c(mean(b.32.mean), sd(b.32.mean))
```

```{r}
{hist(b.2.mean, prob=T, xlim=c(0,4), main="í‘œë³¸í¬ê¸°: 2", col="orange", border="red")
x1 <- seq(min(b.2.mean), max(b.2.mean), length=1000)
y1 <- dnorm(x=x1, mean = 1, sd = sqrt(0.9)/sqrt(2))
lines(x1, y1, lty=2, lwd=2, col="blue")}
```

```{r}
{hist(b.4.mean, prob=T, xlim=c(0,4), main="í‘œë³¸í¬ê¸°: 8", col="orange", border="red")
x2 <- seq(min(b.4.mean), max(b.4.mean), length=1000)
y2 <- dnorm(x=x2, mean = 1, sd = sqrt(0.9)/sqrt(8))
lines(x2, y2, lty=2, lwd=2, col="blue")}
```

```{r}
{hist(b.32.mean, prob=T, xlim=c(0,4), main="í‘œë³¸í¬ê¸°: 32", col="orange", border="red")
x3 <- seq(min(b.32.mean), max(b.32.mean), length=1000)
y3 <- dnorm(x=x3, mean = 1, sd = sqrt(0.9)/sqrt(32))
lines(x3, y3, lty=2, lwd=2, col="blue")}
```






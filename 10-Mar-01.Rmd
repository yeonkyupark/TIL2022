# 2022년 3월

## TIL20220304

### 가설검정

**가설의 종류**

- 대립가설(alternative hypothesis), 모집단에 대한 새로운 주장
- 귀무가설(null hypothesis), 기존의 주장

통계적 검정(statistical test) 또는 가설검정(hypothesis test)이란 표본 데이터를 기반으로 모집단에 대한 새로운 주장의 옮고 그름을 추론하는 과정을 말한다.

**가설검정 절차**

귀무가설이 사실이라는 전제하에서 수행되며 일반적으로 다음과 같은 절차를 따른다.

1. 표본으로부터 검정하고자 하는 **검정통계량(test statistic)** 계산
2. 검정통계량과 그 **확률분포**로부터 p-값(p-value) 계산
  - 귀무가설이 사실이라는 가정하에서 관측한 통계량과 같거나 그보다 더 극단적인 값이 발생할 확률을 의미
  - 유의확률(significance probability)이라고도 함
3. p-값이 매우 작으면 귀무가설 기각
  - 판단의 기준으로 사용하는 5% 또는 1%의 확률을 유의수준(significance level)이라고 함
  - 표본으로부터 관측된 결과(즉 계산된 통계량)가 나타날 가능성이 5% 미만 또는 1% 미만이 되는 귀무가설을 기각하면 이를 통계적으로 유의하다(statistically significant)라고 표현함

**가설검정과 검정력**

[](!http://www.ktword.co.kr/img_data/5094_2.JPG)출처^[<http://www.ktword.co.kr/img_data/5094_2.JPG>]

## TIL20220303

### 데이터 요약

#### 연속형 변수 요약

##### 중심경향 지표

중심경향 지표(measures of central tendency)는 데이터가 특정 값을 중심으로 집중되어 있는 정도를 뜻한다.

-   중위수(median)
-   백분위수(quantile, percentile)
-   사분위수(quartile)
-   평균(mean)

```{r message=TRUE, warning=TRUE}
if(!require(MASS)) install.packages("MASS")
library(MASS) # for survey dataset
```

```{r}
median(survey$Pulse) # 결측, 즉 NA 값에 따른 결과
```

```{r}
median(survey$Pulse, na.rm=T) # 결측값 제거 후 계산산
```

```{r}
quantile(survey$Pulse, probs = 0.5, na.rm = T) # 중위수
```

```{r}
quantile(survey$Pulse, probs = c(0.05, 0.95), na.rm = T)
```

```{r}
# Q1, ... Q4
quantile(survey$Pulse, na.rm = T)
```

```{r}
quantile(survey$Pulse, seq(0,1,0.25), na.rm = T)
```

```{r}
# 주어진 값으로 백분위수 계산
survey$Pulse <=80 # 80보다 작거나 같은 맥박수수
mean(survey$Pulse <= 80, na.rm = T)
```

```{r}
mean(survey$Pulse, na.rm = T)
```

```{r message=TRUE, warning=TRUE}
if(!require(palmerpenguins)) install.packages("palmerpenguins")
library(palmerpenguins)
```

```{r message=TRUE, warning=TRUE}
summary(penguins$body_mass_g)
```

```{r}
summary(penguins$species)
```

```{r}
summary(as.character(penguins$species))
```

```{r}
summary(penguins)
```

```{r}
# list 형태를 인자로 입력하는 경우
penguins.list <- as.list(penguins)
summary(penguins.list)
```

```{r}
# lapply()를 통해 요약통계량 계산
lapply(penguins.list, summary)
```

### 변동성 지표

변동성 지표(measures of variability)는 데이터의 산포 정도를 뜻한다.

-   범위(range)
-   사분위 범위(interquartile range)
-   분산(variance)
-   표준편차(standard deviation)

```{r}
range(survey$Pulse, na.rm = T)
```

```{r}
var(survey$Pulse, na.rm = T)
```

```{r}
sd(survey$Pulse, na.rm = T)
```

R에서는 다양한 기술 통계량을 계산하는 함수들을 제공한다.

```{r message=TRUE, warning=TRUE}
if(!require(pastecs)) install.packages("pastecs")
library(pastecs)
```

```{r}
stat.desc(mtcars[c("mpg", "hp", "wt")])
```

```{r message=TRUE, warning=TRUE}
if(!require(psych)) install.packages("psych")
library(psych)
```

```{r}
describe(mtcars[c("mpg", "hp", "wt")])
```

집단별 기술 통계량을 계산한다.

```{r}
levels(survey$Exer)
```

```{r}
tapply(survey$Pulse, survey$Exer, mean, na.rm = T)
```

```{r}
tapply(survey$Pulse, list(survey$Exer, survey$Sex), mean, na.rm = T)
```

```{r}
aggregate(survey$Pulse, list(Exercise=survey$Exer, Sex=survey$Sex), mean, na.rm = T)
```

```{r}
aggregate(survey[c("Pulse", "Age")],
          list(Exercise=survey$Exer, Sex=survey$Sex), 
          mean, na.rm = T)
```

aggregate()는 FUN 인수에 사용자 정의 함수를 사용할 수 있다.

```{r}
myStats <- function(x, na.rm = F) {
  if(na.rm) x <- x[!is.na(x)]
  n <- length(x)
  mean <- mean(x)
  sd <- sd(x)
  skew <- sum((x-mean)^3/sd^3)/n
  kurt <- sum((x-mean)^4/sd^4)/n - 3
  return(c(n=n, mean=mean, sd=sd, skewness=skew, kurtosis=kurt))
}
```

```{r}
aggregate(survey$Pulse, list(Exercise=survey$Exer, Sex=survey$Sex), myStats, na.rm = T)
```

```{r}
by(survey[c("Pulse", "Age")], 
   list(Exercise=survey$Exer, Sex=survey$Sex), 
   summary)
```

```{r}
aggregate(survey[c("Pulse", "Age")], 
   list(Exercise=survey$Exer, Sex=survey$Sex), 
   summary)
```

```{r}
by(survey[c("Pulse", "Age")], 
   list(Exercise=survey$Exer, Sex=survey$Sex), 
   function(x) sapply(x, myStats, na.rm=T))
```

```{r}
describeBy(survey[c("Pulse", "Age")], group = list(Exercise=survey$Exer))
```

## TIL20220302

### 데이터 요약

#### 범주형 변수 요약

##### 비율 계산

```{r message=TRUE, warning=TRUE}
if(!require(MASS)) install.packages("MASS")
library(MASS)
```

```{r}
survey$Smoke=="Never" # 비흡연자에 대한 논리연산
mean(survey$Smoke=="Never", na.rm = T) # 비흡연자에 대한 비율
```

```{r}
head(anorexia)
```

```{r}
anorexia$Postwt > anorexia$Prewt # 치료 후의 몸무게가 치료 전의 몸무게보다 큰가?
mean(anorexia$Postwt > anorexia$Prewt)
```

```{r}
head(mammals)
```

```{r}
# 두뇌의 무게가 2개의 표준편차보다 큰 논리연산식
abs(mammals$brain - mean(mammals$brain)) > 2*sd(mammals$brain)
```

```{r}
mean(abs(mammals$brain - mean(mammals$brain)) > 2*sd(mammals$brain))
```

```{r}
head(SP500)
```

```{r}
# 수익률이 전일보다 증가한 일자 논리식
head(diff(SP500) > 0, 10)
```

```{r}
mean(diff(SP500) > 0)
```

```{r message=TRUE, warning=TRUE}
if(!require(vcd)) install.packages("vcd")
library(vcd)
```

```{r}
str(Arthritis) # 류마티스 관절염 치료 효과
```

```{r}
levels(Arthritis$Treatment)
levels(Arthritis$Improved)
```

```{r}
crosstab <- table(Arthritis$Improved, Arthritis$Treatment,
                  dnn=c("Improved", "Treatment"))
crosstab
```

```{r}
crosstab["Marked", "Treated"]
```

```{r}
crosstab <- xtabs(~ Improved + Treatment, data = Arthritis)
crosstab
```

```{r}
margin.table(crosstab, margin = 1) # 행
```

```{r}
margin.table(crosstab, margin = 2) # 열
```

```{r}
prop.table(crosstab, margin = 1) # 행의 합이 1
```

```{r}
prop.table(crosstab, margin = 2) # 열의 합이 1
```

```{r}
prop.table(crosstab)
```

```{r}
addmargins(crosstab, margin = 1) # 합의 행을 생성
```

```{r}
addmargins(crosstab, margin = 2) # 합의 열을 생성
```

```{r}
addmargins(crosstab)
```

```{r}
addmargins(prop.table(crosstab, margin = 2), 1)
```

```{r message=TRUE, warning=TRUE}
if(!require(gmodels)) install.packages("gmodels")
library(gmodels)
```

```{r}
CrossTable(Arthritis$Improved, Arthritis$Treatment,
           dnn=c("Improved", "Treatment"))
```

```{r}
multtab <- table(Arthritis$Improved, Arthritis$Sex, Arthritis$Treatment)
multtab
```

```{r}
multtab <- xtabs(~ Improved + Sex + Treatment, data = Arthritis)
multtab
```

```{r}
ftable(multtab)
```

```{r}
ftable(multtab, row.vars = c(2,3))
```

```{r}
ftable(Arthritis[c("Improved", "Sex", "Treatment")], row.vars = c(2,3))
```

```{r}
margin.table(multtab, 1)
margin.table(multtab, 2)
margin.table(multtab, 3)
```

```{r}
ftable(prop.table(multtab, c(2,3)))
```

```{r}
ftable(addmargins(prop.table(multtab, c(2,3))))
```

## TIL20220301

### 데이터 요약

#### 범주형 변수 요약

기술통계와 추론통계, 대부분은 모집단을 설명하는 추론통계이지만 모집단을 잘 설명하기 위해서는 표본집단을 잘 이해사고 적절한 통계기법을 선택하는 것이 중요하다.

##### 빈도표

```{r message=TRUE, warning=TRUE}
if(!require(MASS)) install.packages("MASS")
library(MASS)
```

```{r}
str(survey)
```

```{r}
levels(survey$Smoke)
```

```{r}
frqtab <- table(survey$Smoke)
frqtab
```

```{r}
class(frqtab)
```

```{r}
frqtab[2]
```

```{r}
frqtab["Never"]
```

##### 최빈값

```{r}
frqtab == max(frqtab)
```

```{r}
frqtab[frqtab == max(frqtab)]
```

```{r}
names(frqtab[frqtab == max(frqtab)])
```

```{r}
which.max(frqtab)
```

```{r}
frqtab[which.max(frqtab)]
```

```{r}
names(frqtab[which.max(frqtab)])
```

##### 비율도표

```{r}
frqtab.prop <- prop.table(frqtab)
frqtab.prop
```

```{r}
frqtab.prop["Never"]
```

```{r}
frqtab.prop * 100
```
